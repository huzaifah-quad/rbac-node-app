const swaggerAutogen = require('swagger-autogen')({openapi: '3.0.0'});
const app = require('../src');
const authUser = require('../routes/user/AuthRoute');
const userRoute = require('../routes/user/UserRoute');

const pjson = require('../package.json');

const commonDefinitions = require('./common-definitions');
const doc = {
    info: {
        version: `${pjson.version}_${process.env.BUILD_NUMBER || "0"}`,
        title: "APP Testi API",
        description: "Documentation automatically generated by the <b>swagger-autogen</b> module."
    },
    host: `localhost:4000`,
    basePath: "/",
    schemes: ["https", "http"],
    consumes: ['application/json'],
    produces: ['application/json'],
    tags: [
        
    ],
    securityDefinitions: {
        basicAuth: {
            type: "bearer"
        }
    },
    // Auto gen version (used for response)
    definitions: {
        ...userRoute.definitionMenuResponse,
        ...authUser.definitionResponse,
        ...commonDefinitions
    }
}

const outputFile = './swagger-output.json'
const endpointsFiles = ['../routes/index']

swaggerAutogen(outputFile, endpointsFiles, doc).then(() => app);